Core=function(){this.layerType=["green","sport"];this.layerID={region:-1,green:0,sport:1};this.layerCaptions={};this.layerCaptions[this.layerID.region]="Regions";var b=this;this.plotRegionStat=function(f,d,c,l){var a={top:60,right:50,bottom:20,left:50},m=!0,h=200-a.left-a.right,q=400-a.left-a.right,n=200-a.top-a.bottom,r=400-a.top-a.bottom,t="rgb(225,151,76) rgb(132,186,91) rgb(211,94,96) rgb(128,133,133) rgb(144,103,167) rgb(171,104,87) rgb(204,194,16)".split(" ");d3.scale.linear().domain([0,100]).range([0,
100]);var k=d3.scale.linear().domain([0,100]).range([0,100]),g=d3.scale.linear().domain([0,100]).range([0,100]),u=d3.scale.linear().domain([0,100]).range([0,100]),v=d3.scale.linear().domain([0,100]).range([0,100]),w=d3.scale.linear().domain([0,100]).range([0,100]),x=d3.scale.linear().domain([0,100]).range([0,100]),y=d3.scale.linear().domain([0,100]).range([0,100]),z=d3.scale.linear().domain([0,100]).range([0,100]),k={activity:k,culinary:g,cultural:u,green:v,nonleisure:w,relaxation:x,spiritual:y,sport:z},
g=[],p;for(p in l)g.push(t[l[p]]);"chartBig"===c&&(h=q,n=r,m=!1);var e=d3.select(".hist").append("svg").attr("class",c).attr("width",h+a.left+a.right).attr("height",n+a.top+a.bottom);f=starPlot().width(h).propertiesList(f).scales(k).colours(g).title(d).margin(a).labelMargin(20);e.append("g").call(f);if(m)e.selectAll(".star-interaction").on("mouseover",function(a){e.selectAll(".star-label").style("display","none");e.append("circle").attr("class","interaction-circle").attr("r",4).attr("cx",a.x).attr("cy",
a.y).attr("fill","gray");e.append("text").attr("class","star-interaction-label").text(a.key+":  "+Math.round(10*a.value)/10).attr("x",a.textX).attr("y",a.textY)}).on("mouseout",function(a){e.selectAll(".star-label").style("display","");e.selectAll(".interaction-circle").remove();e.selectAll(".star-interaction-label").remove()}).on("click",function(a){b.showMapStatHandle(b.layerID[a.key],c.substr(5).split(","))})};this.setShowMapStatHandle=function(f){b.showMapStatHandle=f;ajax("/data/objects/types",
function(d){b.layerType=d;for(d=0;d<b.layerType.length;++d)b.layerID[b.layerType[d]]=d;b.layerType.forEach(function(c){b.layerCaptions[b.layerID[c]]=c;$(".dropdown-menu").html($(".dropdown-menu").html()+'<li><a href="#" id="'+c+'-layer-switcher">'+c+"</a></li>");$(".dropdown-menu").on("click","#"+c+"-layer-switcher",function(){$("span#layer-caption").html(c);f(b.layerID[c])})})});$(".dropdown-menu").on("click","#region-layer-switcher",function(){$("span#layer-caption").html("Regions");f(b.layerID.region)})}};
var core=new Core,map=new Map(core);core.setShowMapStatHandle(map.showMapStat);map.drawRegions();
