Core=function(){this.layerType=["green","sport"];this.layerID={region:-1,green:0,sport:1};this.layerCaptions={};this.layerCaptions[this.layerID.region]="Regions";this.colours="rgb(255,177,31) rgb(156,230,228) rgb(232,123,141) rgb(128,133,133) rgb(144,103,167) rgb(171,104,87) rgb(204,194,16)".split(" ");var c=this;this.showPopupHandler=null;$(".board").animate({"margin-right":"-=500"});this.plotRegionStat=function(g,d,b,k,a){a={top:60,right:60,bottom:20,left:60};var p=!0,f=.3*window.innerWidth/2-.01*
window.innerWidth,h=.6*window.innerHeight/2-.01*window.innerWidth;h<f&&(f=h);var h=f-a.left-a.right,r=1.5*f-a.left-a.right,q=f-a.top-a.bottom,f=1.5*f-a.top-a.bottom;d3.scale.linear().domain([0,100]).range([0,100]);var n=d3.scale.linear().domain([0,100]).range([0,100]),m=d3.scale.linear().domain([0,100]).range([0,100]),t=d3.scale.linear().domain([0,100]).range([0,100]),u=d3.scale.linear().domain([0,100]).range([0,100]),v=d3.scale.linear().domain([0,100]).range([0,100]),w=d3.scale.linear().domain([0,
100]).range([0,100]),x=d3.scale.linear().domain([0,100]).range([0,100]),y=d3.scale.linear().domain([0,100]).range([0,100]),n={activity:n,culinary:m,cultural:t,green:u,nonleisure:v,relaxation:w,spiritual:x,sport:y},m=[],l;for(l in k)m.push(this.colours[k[l]]);k=".starPlots";l="inline";"chartBig"===b&&(h=r,q=f,p=!1,k=".bigPlot",l="block");var e=d3.select(k).append("svg").attr("class",b).attr("width",h+a.left+a.right).attr("height",q+a.top+a.bottom).style("display",l).style("vertical-align","middle").style("margin",
"auto");e.text("test");g=starPlot().width(h).propertiesList(g).scales(n).colours(m).title(d).margin(a).labelMargin(15);e.append("g").call(g);e.selectAll(".star-interaction").on("mouseover",function(a){p&&(e.selectAll(".star-label").style("display","none"),e.append("circle").attr("class","interaction-circle").attr("r",4).attr("cx",a.x).attr("cy",a.y).attr("fill","gray"),e.append("text").attr("class","star-interaction-label").text(a.key+":  "+Math.round(10*a.value)/10).attr("x",a.textX).attr("y",a.textY))}).on("mouseout",
function(a){e.selectAll(".star-label").style("display","");e.selectAll(".interaction-circle").remove();e.selectAll(".star-interaction-label").remove()}).on("click",function(a){var b=(""+d).split(",");c.showMapStatHandle(c.layerID[a.key],b);1==b.length&&c.showPopupHandler(b[0])})};this.setShowMapStatHandle=function(g){c.showMapStatHandle=g;ajax("/data/objects/types",function(d){c.layerType=d;for(d=0;d<c.layerType.length;++d)c.layerID[c.layerType[d]]=d;c.layerType.forEach(function(b){c.layerCaptions[c.layerID[b]]=
b;$(".dropdown-menu").html($(".dropdown-menu").html()+'<li><a href="#" id="'+b+'-layer-switcher">'+b+"</a></li>");$(".dropdown-menu").on("click","#"+b+"-layer-switcher",function(){$("span#layer-caption").html(b);g(c.layerID[b])})})});$(".dropdown-menu").on("click","#region-layer-switcher",function(){$("span#layer-caption").html("Regions");g(c.layerID.region)})}};var core=new Core,map=new Map(core);core.setShowMapStatHandle(map.showMapStat);core.showPopupHandler=map.showPopup;map.drawRegions();
